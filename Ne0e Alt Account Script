-- Ne0e Alt Account Control (bang & unbang komutları eklendi, flingall kaldırıldı)

local config = {
    mainAccount = "Xper1tiz", -- Main hesabının kullanıcı adı
    altAccount = "semih53sn2", -- Alt hesabının kullanıcı adı
    commands = {
        ".goto <kullanıcı>",
        ".follow <kullanıcı>",
        ".stop",
        ".spin",
        ".unspin",
        ".orbit <kullanıcı>",
        ".unorbit",
        ".fling <kullanıcı>",
        ".lag",
        ".unlag",
        ".re",
        ".chat <mesaj>",
        ".bang <kullanıcı>",
        ".unbang",
        ".headsit <kullanıcı>",
        ".unheadsit"
    }
}

local Players = game:GetService("Players")
local lp = Players.LocalPlayer
local TextChatService = game:GetService("TextChatService")
local StarterGui = game:GetService("StarterGui")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local isMain = (lp.Name == config.mainAccount)
local isAlt = (lp.Name == config.altAccount)

-- Bildirim
pcall(function()
    StarterGui:SetCore("SendNotification", {
        Title = "Ne0e Alt Control",
        Text = "Script başarıyla başlatıldı!",
        Duration = 5
    })
end)

-- Kısmi isimle oyuncu bulma
local function findPlayerByPartialName(partial)
    partial = partial:lower()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr.Name:lower():sub(1, #partial) == partial then
            return plr
        end
    end
    return nil
end

-- ALT HESAPTA SİYAH EKRAN VE YAZI
if isAlt then
    local gui = Instance.new("ScreenGui")
    gui.Name = "Ne0eAltAccountScreen"
    gui.Parent = lp:WaitForChild("PlayerGui")
    gui.ResetOnSpawn = false

    local bg = Instance.new("Frame", gui)
    bg.Size = UDim2.new(1,0,1,0)
    bg.Position = UDim2.new(0,0,0,0)
    bg.BackgroundColor3 = Color3.new(0,0,0)

    local label = Instance.new("TextLabel", bg)
    label.Size = UDim2.new(1,0,1,0)
    label.Position = UDim2.new(0,0,0,0)
    label.BackgroundTransparency = 1
    label.Text = "Ne0e Alt Account Script Working"
    label.TextColor3 = Color3.fromRGB(80, 255, 180)
    label.Font = Enum.Font.GothamBlack
    label.TextScaled = true
end

-- SADECE MAIN HESAPTA KOMUT LİSTESİ KUTUSU (scroll up/down)
if isMain then
    local gui = Instance.new("ScreenGui")
    gui.Name = "Ne0eAltAccountCmdList"
    gui.Parent = lp:WaitForChild("PlayerGui")
    gui.ResetOnSpawn = false

    local main = Instance.new("Frame", gui)
    main.Size = UDim2.new(0, 340, 0, 340)
    main.Position = UDim2.new(0, 40, 0, 120)
    main.BackgroundColor3 = Color3.fromRGB(32, 34, 44)
    main.BorderSizePixel = 0
    main.Active = true
    main.Draggable = true
    local mainCorner = Instance.new("UICorner", main)
    mainCorner.CornerRadius = UDim.new(0, 12)

    local title = Instance.new("TextLabel", main)
    title.Size = UDim2.new(1, 0, 0, 32)
    title.Position = UDim2.new(0, 0, 0, 0)
    title.BackgroundColor3 = Color3.fromRGB(22, 22, 28)
    title.Text = "Ne0e Alt Account Komutlar"
    title.TextColor3 = Color3.fromRGB(80, 180, 255)
    title.Font = Enum.Font.GothamBlack
    title.TextScaled = true
    title.BorderSizePixel = 0
    local titleCorner = Instance.new("UICorner", title)
    titleCorner.CornerRadius = UDim.new(0, 12)

    -- Scrollable komut listesi
    local scroll = Instance.new("ScrollingFrame", main)
    scroll.Size = UDim2.new(1, -24, 1, -52)
    scroll.Position = UDim2.new(0, 12, 0, 40)
    scroll.BackgroundColor3 = Color3.fromRGB(44, 48, 70)
    scroll.BorderSizePixel = 0
    scroll.CanvasSize = UDim2.new(0, 0, 0, #config.commands * 32)
    scroll.ScrollBarThickness = 8
    scroll.AutomaticCanvasSize = Enum.AutomaticSize.Y
    scroll.VerticalScrollBarInset = Enum.ScrollBarInset.ScrollBar

    local scrollCorner = Instance.new("UICorner", scroll)
    scrollCorner.CornerRadius = UDim.new(0, 8)

    local layout = Instance.new("UIListLayout", scroll)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 4)

    for _, v in ipairs(config.commands) do
        local cmdLabel = Instance.new("TextLabel", scroll)
        cmdLabel.Size = UDim2.new(1, -8, 0, 28)
        cmdLabel.BackgroundTransparency = 1
        cmdLabel.TextColor3 = Color3.fromRGB(180, 220, 255)
        cmdLabel.Font = Enum.Font.Gotham
        cmdLabel.TextSize = 16
        cmdLabel.Text = v
        cmdLabel.TextXAlignment = Enum.TextXAlignment.Left
    end

    -- Scroll Up/Down Butonları
    local scrollUp = Instance.new("TextButton", main)
    scrollUp.Size = UDim2.new(0, 32, 0, 24)
    scrollUp.Position = UDim2.new(1, -44, 0, 40)
    scrollUp.BackgroundColor3 = Color3.fromRGB(80, 180, 255)
    scrollUp.Text = "▲"
    scrollUp.TextColor3 = Color3.fromRGB(30,30,40)
    scrollUp.Font = Enum.Font.GothamBold
    scrollUp.TextScaled = true
    local scrollUpCorner = Instance.new("UICorner", scrollUp)
    scrollUpCorner.CornerRadius = UDim.new(0, 8)

    local scrollDown = Instance.new("TextButton", main)
    scrollDown.Size = UDim2.new(0, 32, 0, 24)
    scrollDown.Position = UDim2.new(1, -44, 1, -36)
    scrollDown.BackgroundColor3 = Color3.fromRGB(80, 180, 255)
    scrollDown.Text = "▼"
    scrollDown.TextColor3 = Color3.fromRGB(30,30,40)
    scrollDown.Font = Enum.Font.GothamBold
    scrollDown.TextScaled = true
    local scrollDownCorner = Instance.new("UICorner", scrollDown)
    scrollDownCorner.CornerRadius = UDim.new(0, 8)

    scrollUp.MouseButton1Click:Connect(function()
        scroll.CanvasPosition = Vector2.new(0, math.max(scroll.CanvasPosition.Y - 32, 0))
    end)
    scrollDown.MouseButton1Click:Connect(function()
        scroll.CanvasPosition = Vector2.new(0, math.min(scroll.CanvasPosition.Y + 32, scroll.AbsoluteCanvasSize.Y - scroll.AbsoluteWindowSize.Y))
    end)
end

-- ALT HESAP KOMUT DİNLEME (.prefix ve oto isim)
if isAlt then
    local spinObj, orbitConn, lagConn
    local isSpinning = false
    local isOrbiting = false
    local isLagging = false

    -- Bang değişkenleri
    local bangActive = false
    local bangConn = nil
    local bangAnimTrack = nil

    local function stopBang()
        bangActive = false
        if bangConn then bangConn:Disconnect() end
        bangConn = nil
        if bangAnimTrack then bangAnimTrack:Stop() end
        bangAnimTrack = nil
    end

    local function bangPlayer(targetPlr)
        local char = lp.Character
        local targetChar = targetPlr and targetPlr.Character
        if not char or not targetChar then return end

        local root = char:FindFirstChild("HumanoidRootPart")
        local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
        if not root or not targetRoot then return end

        local humanoid = char:FindFirstChildOfClass("Humanoid")
        if not humanoid then return end

        -- Animasyon
        local anim = Instance.new("Animation")
        anim.AnimationId = "rbxassetid://148840371" -- Dance animasyonu (örnek)
        bangAnimTrack = humanoid:LoadAnimation(anim)
        bangAnimTrack.Looped = true
        bangAnimTrack:Play()
        game:GetService("Debris"):AddItem(anim, 2)

        bangActive = true

        -- Takip ve bang işlemi (arkasına ve çok yakın, çok hızlı)
        bangConn = RunService.RenderStepped:Connect(function()
            if not bangActive or not root or not targetRoot then return end
            local behind = targetRoot.CFrame.Position - (targetRoot.CFrame.LookVector * 0.5)
            local newCFrame = CFrame.new(behind, targetRoot.Position)
            root.CFrame = root.CFrame:Lerp(newCFrame, 0.9)
            if bangAnimTrack and not bangAnimTrack.IsPlaying then
                bangAnimTrack:Play()
            end
        end)
    end

    local function handleCommand(cmd, arg)
        local char = lp.Character or lp.CharacterAdded:Wait()
        local hum = char:FindFirstChildOfClass("Humanoid")
        if not hum then return end

        local target = nil
        if arg and arg ~= "" then
            target = findPlayerByPartialName(arg)
        end

        -- .goto
        if cmd == "goto" and target then
            if target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                char:MoveTo(target.Character.HumanoidRootPart.Position + Vector3.new(0,2,0))
            end
        end

        -- .follow
        if cmd == "follow" and target then
            if target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                if not _G._ne0e_following then
                    _G._ne0e_following = true
                    spawn(function()
                        while _G._ne0e_following and target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") and lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") do
                            local myHRP = lp.Character.HumanoidRootPart
                            local targetHRP = target.Character.HumanoidRootPart
                            local dist = (myHRP.Position - targetHRP.Position).Magnitude
                            if dist > 3 then
                                hum:MoveTo(targetHRP.Position + targetHRP.CFrame.LookVector * -2)
                            end
                            wait(0.2)
                        end
                    end)
                end
            end
        end

        -- .stop
        if cmd == "stop" then
            _G._ne0e_following = false
        end

        -- .spin
        if cmd == "spin" then
            if not isSpinning and char:FindFirstChild("HumanoidRootPart") then
                isSpinning = true
                spinObj = Instance.new("BodyAngularVelocity")
                spinObj.Name = "Ne0eSpin"
                spinObj.Parent = char.HumanoidRootPart
                spinObj.MaxTorque = Vector3.new(0, math.huge, 0)
                spinObj.AngularVelocity = Vector3.new(0, 10, 0)
            end
        end

        -- .unspin
        if cmd == "unspin" then
            isSpinning = false
            if spinObj and spinObj.Parent then
                spinObj:Destroy()
            end
        end

        -- .orbit <kullanıcı>
        if cmd == "orbit" and target then
            if not isOrbiting and char:FindFirstChild("HumanoidRootPart") then
                isOrbiting = true
                local radius = 6
                local speed = 2
                local angle = 0
                orbitConn = RunService.Heartbeat:Connect(function(dt)
                    if not isOrbiting or not target.Character or not target.Character:FindFirstChild("HumanoidRootPart") then return end
                    angle = angle + dt * speed
                    local offset = Vector3.new(math.cos(angle) * radius, 0, math.sin(angle) * radius)
                    char.HumanoidRootPart.CFrame = CFrame.new(target.Character.HumanoidRootPart.Position + offset, target.Character.HumanoidRootPart.Position)
                end)
            end
        end

        -- .unorbit
        if cmd == "unorbit" then
            isOrbiting = false
            if orbitConn then
                orbitConn:Disconnect()
                orbitConn = nil
            end
        end

        -- .fling <kullanıcı>
        if cmd == "fling" and target then
            local char = lp.Character or lp.CharacterAdded:Wait()
            local hrp = char:FindFirstChild("HumanoidRootPart")
            for _, v in pairs(char:GetChildren()) do
                if v:IsA("BasePart") then
                    v.Massless = true
                end
            end

            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                local targetHRP = target.Character.HumanoidRootPart
                local bav = Instance.new("BodyAngularVelocity", targetHRP)
                bav.Name = "Ne0eTargetFlingBAV"
                bav.AngularVelocity = Vector3.new(0, 1E5, 0)
                bav.MaxTorque = Vector3.new(0, math.huge, 0)
                bav.P = math.huge

                local t = tick()
                while tick() - t < 1.2 and target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") do
                    hrp.CFrame = target.Character.HumanoidRootPart.CFrame
                    bav.AngularVelocity = Vector3.new(0, 1E5, 0)
                    RunService.Heartbeat:Wait()
                end

                bav:Destroy()
            end
        end

        -- .lag
        if cmd == "lag" then
            if not isLagging then
                isLagging = true
                lagConn = RunService.Heartbeat:Connect(function()
                    if char and char:FindFirstChild("HumanoidRootPart") then
                        char.HumanoidRootPart.CFrame = char.HumanoidRootPart.CFrame * CFrame.new(math.random(-2,2), math.random(-2,2), math.random(-2,2))
                    end
                end)
            end
        end

        -- .unlag
        if cmd == "unlag" then
            isLagging = false
            if lagConn then
                lagConn:Disconnect()
                lagConn = nil
            end
        end

        -- .re (reset)
        if cmd == "re" then
            if hum then
                hum.Health = 0
            end
        end

        -- .chat <mesaj>
        if cmd == "chat" and arg and arg ~= "" then
            -- Yeni chat sistemi
            if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
                local channel = TextChatService.TextChannels and TextChatService.TextChannels.RBXGeneral
                if channel then
                    channel:SendAsync(arg)
                end
            else
                -- Eski chat sistemi
                local chatEvent = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
                if chatEvent then
                    local say = chatEvent:FindFirstChild("SayMessageRequest")
                    if say then
                        say:FireServer(arg, "All")
                    end
                end
            end
        end

        -- .bang <kullanıcı>
        if cmd == "bang" and target then
            stopBang()
            bangPlayer(target)
        end

        -- .unbang
        if cmd == "unbang" then
            stopBang()
        end
    end

        -- Headsit değişkenleri
    local headsitActive = false
    local headsitConn = nil

    local function stopHeadsit()
        headsitActive = false
        if headsitConn then headsitConn:Disconnect() end
        headsitConn = nil
    end

    local function headsitPlayer(targetPlr)
        local char = lp.Character
        local targetChar = targetPlr and targetPlr.Character
        if not char or not targetChar then return end

        local root = char:FindFirstChild("HumanoidRootPart")
        local targetRoot = targetChar:FindFirstChild("Head")
        if not root or not targetRoot then return end

        headsitActive = true

        headsitConn = RunService.RenderStepped:Connect(function()
            if not headsitActive or not root or not targetRoot then return end
            -- Head'in biraz üstüne oturur gibi pozisyonla
            local above = targetRoot.Position + Vector3.new(0, 0.7, 0)
            root.CFrame = CFrame.new(above, targetRoot.Position + Vector3.new(0, 2, 0))
        end)
    end

    local function handleCommand(cmd, arg)
        -- ...existing code...

        -- .headsit <kullanıcı>
        if cmd == "headsit" and target then
            stopHeadsit()
            headsitPlayer(target)
        end

        -- .unheadsit
        if cmd == "unheadsit" then
            stopHeadsit()
        end
    end

    -- Yeni chat sistemi
    if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
        TextChatService.MessageReceived:Connect(function(msg)
            if msg.TextSource and msg.TextSource.Name == config.mainAccount then
                local text = msg.Text
                local cmd, arg = text:match("^%.(%w+)%s*(.*)") -- .prefix ile
                if cmd then
                    handleCommand(cmd:lower(), arg)
                end
            end
        end)
    else
        -- Eski chat sistemi
        for _, player in ipairs(Players:GetPlayers()) do
            player.Chatted:Connect(function(message)
                if player.Name == config.mainAccount then
                    local cmd, arg = message:match("^%.(%w+)%s*(.*)") -- .prefix ile
                    if cmd then
                        handleCommand(cmd:lower(), arg)
                    end
                end
            end)
        end
        Players.PlayerAdded:Connect(function(player)
            player.Chatted:Connect(function(message)
                if player.Name == config.mainAccount then
                    local cmd, arg = message:match("^%.(%w+)%s*(.*)") -- .prefix ile
                    if cmd then
                        handleCommand(cmd:lower(), arg)
                    end
                end
            end)
        end)
    end
end
